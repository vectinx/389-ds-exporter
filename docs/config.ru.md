# Конфигурационный файл

389-ds-exporter настраивается с помощью 2 YAML-файлов:
- `config.yml` - конфигурация экспортера (параметры подключения к LDAP, список коллекторов и т.д.)
- `web-config.yml` - веб-конфигурация экспортера на базе [Prometheus web.config.file](https://prometheus.io/docs/prometheus/latest/configuration/https/) (параметры TLS, HTTP, BasicAuth и т.д.)

## Параметры конфигурационного файла экспортера

### collectors_default
Набор коллекторов, включаемых по умолчанию.
Возможные значения:
- `all` — включает все доступные коллекторы;
- `none` — отключает все коллекторы;
- `standard` — включает стандартный набор коллекторов.

Значение по умолчанию: `standard`

---

### ds_numsubordinate_records
Список LDAP-записей, для которых будет собираться информация о числе подчинённых записей (`numSubordinates`).
Значение по умолчанию: `[]`

---

### collectors_enabled
Список включаемых коллекторов.
Используется для включения отдельных коллекторов, если `collectors_default` не равен `all`.

---

### shutdown_timeout
Максимальное время (в секундах), которое сервер будет ждать корректного завершения работы всех ресурсов при остановке приложения.
В течение этого периода сервер перестаёт принимать новые соединения, завершает обработку текущих запросов и корректно закрывает HTTP-сервер, пул соединений LDAP и другие ресурсы.
Если таймаут превышен, оставшиеся соединения будут закрыты принудительно.
Значение `0` означает, что корректное завершение будет пропущено.

Значение по умолчанию: `5`

## LDAP

### ldap_server_url
Адрес LDAP-сервера в формате RFC-2255.
Примеры: `ldap://localhost:389` или `ldaps://remote-server`

Значение по умолчанию: `ldap://localhost:389`

---

### ldap_bind_dn
DN учётной записи, используемой для аутентификации на LDAP-сервере.

---

### ldap_bind_pw
Пароль от LDAP-учётной записи.

---

### ldap_tls_skip_verify
Пропустить проверку TLS при подключении к LDAP.

Значение по умолчанию: `false`

---

### ldap_pool_conn_limit
Максимальный размер пула соединений LDAP.
Рекомендуемое и стандартное значение — `5`.
Если меньше — сборщики метрик могут блокироваться при ожидании соединений, замедляя работу экспортера.

Значение по умолчанию: `5`

---

### ldap_pool_get_timeout
Таймаут (в секундах) для получения соединения из пула.
Если соединение не удалось получить соединение в течение этого времени — возвращается ошибка.

Значение по умолчанию: `5`

---

### ldap_dial_timeout
Таймаут создания LDAP-соединения.
Это время не включает BIND, только открытие соединения.

Значение по умолчанию: `3`

---

### ldap_pool_idle_time
Количество времени, которое неиспользуемое соединение остается в пуле.
Если в течение этого времени соединение не будет никем использовано - оно будет закрыто.

Значение по умолчанию: `600`

---

### ldap_pool_life_time
Время жизни соединения. По истечении этого времени соединение закрывается

Значение по умолчанию: `3600`

## Параметры WEB-конфигурации экспортера

Параметры web-конфигурации определяеются стандартным конфигурационным файлом Prometheus `web-config.yml`.
Описание параметров конфигурации доступно по [ссылке](https://prometheus.io/docs/prometheus/latest/configuration/https/)
